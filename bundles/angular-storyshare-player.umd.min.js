!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("angular-storyshare-player",["exports","@angular/core","@angular/common","@angular/common/http"],e):e((t=t||self)["angular-storyshare-player"]={},t.ng.core,t.ng.common,t.ng.common.http)}(this,(function(t,e,o,s){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function n(t,e,o,s){var n,i=arguments.length,r=i<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,s);else for(var p=t.length-1;p>=0;p--)(n=t[p])&&(r=(i<3?n(r):i>3?n(e,o,r):n(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r}var i,r=function(){function t(){}return t.prototype.storiesChange=function(t){this.stories=t},n([e.Input()],t.prototype,"stories",void 0),n([e.Input()],t.prototype,"user",void 0),t=n([e.Component({selector:"app-player-stories",template:'<div class="container">\n    <div class="container-top-player">\n        <app-progress-wrapper-player class="component" id="progress" [stories]="stories"></app-progress-wrapper-player>\n        <app-header [img]="user.img" [name]="user.name"></app-header>\n    </div>\n    <app-content-player id="content-player" [stories]="stories" (storiesChange)="storiesChange($event)" ></app-content-player>\n</div>\n',styles:[".container{width:393.75px;height:700px;margin-top:20px;position:relative}.container-top-player{display:flex;flex-direction:column;margin-top:15px;z-index:1;position:absolute;left:0;top:0;width:100%}"]})],t)}(),p=function(){function t(){}return t.prototype.ngOnInit=function(){},n([e.Input()],t.prototype,"name",void 0),n([e.Input()],t.prototype,"img",void 0),t=n([e.Component({selector:"app-header",template:'<div class="container-header">\n  <img id="logo" src={{img}}>\n  <p id="name">{{name}}</p>\n</div>\n',styles:[".container-header{display:flex;flex-direction:row;align-items:center;margin-top:10px}#logo{height:35px;width:35px;padding:0 10px;border-radius:50%}#name{font-size:14px;color:#fdfdfd;font-family:Arial,Helvetica,sans-serif}"]})],t)}(),a=function(){function t(){}return t.prototype.ngOnInit=function(){},n([e.Input()],t.prototype,"stories",void 0),t=n([e.Component({selector:"app-progress-wrapper-player",template:'<div class="wrapper">\n  <app-progress-player [width]="story.progression" *ngFor="let story of stories"></app-progress-player>\n</div>\n',styles:[".wrapper{display:flex;flex-direction:row;width:100%}app-progress-player{width:100%;margin-left:2px;margin-right:2px}"]})],t)}();(i=t.Type||(t.Type={}))[i.Image=0]="Image",i[i.Video=1]="Video";var u=function(){function o(){this.typeVideo=t.Type.Video,this.typeImg=t.Type.Image,this.storyPosition=0,this.isPause=!1,this.storiesChange=new e.EventEmitter}return o.prototype.ngOnInit=function(){},o.prototype.ngOnChanges=function(t){var e=this;setTimeout((function(){void 0!==e.stories&&(e.currentStory=e.stories[e.storyPosition],e.loop(e.currentStory),console.log(e.storyContent),e.storyContentWidth=e.storyContent.nativeElement.offsetWidth)}),50)},o.prototype.ngAfterViewInit=function(){},o.prototype.loop=function(t){var e=this;this.startDate=(new Date).getTime(),this.storyPosition<=this.stories.length&&(this.timerId=setInterval((function(){e.isPause||e.checkEndStory(e.startDate)}),1))},o.prototype.checkEndStory=function(t){this.currentDate=(new Date).getTime();var e=this.currentDate-t;e>this.currentStory.duration?this.storyPosition<this.stories.length-1&&this.next():(this.progressPosition=100*e/this.currentStory.duration,this.stories[this.storyPosition].progression=this.progressPosition,this.storiesChange.emit(this.stories))},o.prototype.clickEvent=function(t){var e=t.offsetX,o=this.storyContentWidth/3;e<o&&this.previous(),e>this.storyContentWidth-o&&this.next()},o.prototype.next=function(){clearInterval(this.timerId),this.storyPosition<this.stories.length-1?(this.storyPosition=this.storyPosition+1,this.currentStory=this.stories[this.storyPosition],this.loop(this.currentStory)):(this.storyPosition=this.stories.length-1,this.currentStory=this.stories[this.storyPosition]),this.changeProgressionStory(this.storyPosition)},o.prototype.previous=function(){clearInterval(this.timerId);this.storyPosition;this.storyPosition>0?this.storyPosition=this.storyPosition-1:this.storyPosition=0,this.changeProgressionStory(this.storyPosition),this.currentStory=this.stories[this.storyPosition],this.loop(this.currentStory)},o.prototype.changeProgressionStory=function(t){for(var e=0;e<this.stories.length;e++)e<t?this.stories[e].progression=100:e>t?this.stories[e].progression=0:t===this.stories.length-1&&(this.stories[e].progression=100);this.storiesChange.emit(this.stories)},o.prototype.onLongPress=function(){this.isPause=!0,this.currentStory.type==this.typeVideo&&this.pauseVideo()},o.prototype.onLongPressEnd=function(){this.isPause&&(this.isPause=!1,this.currentStory.type==this.typeVideo&&this.playVideo())},o.prototype.playVideo=function(){this.video.nativeElement.play()},o.prototype.pauseVideo=function(){this.video.nativeElement.pause()},n([e.Input()],o.prototype,"stories",void 0),n([e.Output()],o.prototype,"storiesChange",void 0),n([e.ViewChild("storyContent")],o.prototype,"storyContent",void 0),n([e.ViewChild("video")],o.prototype,"video",void 0),o=n([e.Component({selector:"app-content-player",template:'<div long-press (onLongPress)="onLongPress()" (onLongPressEnd)="onLongPressEnd()" class="content" #storyContent (click)="clickEvent($event)">\n  <video *ngIf="currentStory!==undefined && currentStory.type === typeVideo" width="100%" height="100%" autoplay="true" muted="false" #video>\n    <source src={{currentStory.source}} type="video/mp4">\n    Sorry, your browser doesn\'t support embedded videos.\n  </video>\n  <img *ngIf="currentStory!==undefined && currentStory.type === typeImg" width="100%" height="100%" src={{currentStory.source}}>\n</div>\n',styles:[".content{height:100%;width:100%}"]})],o)}(),h=function(){function t(){}return t.prototype.ngOnInit=function(){},n([e.Input()],t.prototype,"width",void 0),t=n([e.Component({selector:"app-progress-player",template:'<div class="progress-bar first">\n  <div [ngStyle]="{\'width.%\':width}" class="progress-bar second">\n  </div>\n</div>',styles:[".first{width:100%;background-color:#eee}.second{background-color:#b5c0c4}.progress-bar{border-radius:16px;height:2px}"]})],t)}(),c=function(){function t(){this.duration=500,this.onLongPress=new e.EventEmitter,this.onLongPressing=new e.EventEmitter,this.onLongPressEnd=new e.EventEmitter,this.mouseX=0,this.mouseY=0}return Object.defineProperty(t.prototype,"press",{get:function(){return this.pressing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longPress",{get:function(){return this.longPressing},enumerable:!0,configurable:!0}),t.prototype.onMouseDown=function(t){var e=this;1===t.which&&(this.mouseX=t.clientX,this.mouseY=t.clientY,this.pressing=!0,this.longPressing=!1,this.timeout=setTimeout((function(){e.longPressing=!0,e.onLongPress.emit(t),e.loop(t)}),this.duration),this.loop(t))},t.prototype.onMouseMove=function(t){if(this.pressing&&!this.longPressing){var e=t.clientX-this.mouseX>10,o=t.clientY-this.mouseY>10;(e||o)&&this.endPress()}},t.prototype.loop=function(t){var e=this;this.longPressing&&(this.timeout=setTimeout((function(){e.onLongPressing.emit(t),e.loop(t)}),50))},t.prototype.endPress=function(){clearTimeout(this.timeout),this.longPressing=!1,this.pressing=!1,this.onLongPressEnd.emit(!0)},t.prototype.onMouseUp=function(){this.endPress()},n([e.Input()],t.prototype,"duration",void 0),n([e.Output()],t.prototype,"onLongPress",void 0),n([e.Output()],t.prototype,"onLongPressing",void 0),n([e.Output()],t.prototype,"onLongPressEnd",void 0),n([e.HostBinding("class.press")],t.prototype,"press",null),n([e.HostBinding("class.longpress")],t.prototype,"longPress",null),n([e.HostListener("mousedown",["$event"])],t.prototype,"onMouseDown",null),n([e.HostListener("mousemove",["$event"])],t.prototype,"onMouseMove",null),n([e.HostListener("mouseup")],t.prototype,"onMouseUp",null),t=n([e.Directive({selector:"[long-press]"})],t)}(),l=function(){function t(){}return t=n([e.NgModule({imports:[o.CommonModule,s.HttpClientModule],providers:[],declarations:[r,u,a,h,c,p],exports:[r]})],t)}(),y=function(){};t.PlayerVideoComponent=r,t.PlayerVideoModule=l,t.User=y,t.ɵa=u,t.ɵb=a,t.ɵc=h,t.ɵd=c,t.ɵe=p,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-storyshare-player.umd.min.js.map